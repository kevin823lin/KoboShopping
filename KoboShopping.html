<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Kobo Shopping</title>
  </head>
  <body>
    <h1>Kobo Shopping</h1>
    <div>Book prices: <input type='text' id='prices' size='100' value='266 245'></input>(separated by space)</div> <!--  228 273 286 290 315 247 247 -->
    <div>Target bundle price: <input type='text' id='target' size='4' value='888'></input></div>
    <div><button id='go-btn'>go</button></div>
  </body>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>
  <script>
    var solution_carts = [];
    var solution_rewards = 0;
    var solution_residual = 0;
    var carts = [];
    var prices = [];

    $(document).ready(function() {
        $( "#go-btn" ).click(function() {
            var px = $('#prices').val().split(' ');
            var i;
            prices = [];
            for (i = 0; i < px.length; i++) {
                prices.push(Number(px[i]));
            }
            var target = Number($('#target').val());
            solution_residual = _sum(prices);
            alert(solution_residual);
            _go(0, target);
            var text = "";
            for (i = 0; i < solution_carts.length; i++) {
                text += "Cart " + i + ": ";
                var j;
                for (j = 0; j < solution_carts[i].length; j++) {
                    text += j
                    if (j < solution_carts.length - 1)
                        text += " + ";
                }
                text += " = " + _sum(solution_carts[j]) + "\n";
            }
            alert(text);
        });
    });
    function _go(i, target) {
       if (i == prices.length) {
           var rewards = 0, residual = 0, j = 0;
           for (j = 0; j < carts.length; j++) {
               var sum = _sum(carts[j]);
               if (sum >= target) {
                   rewards++;
                   residual += sum - target;
               }
           }
           if (rewards > solution_rewards || (rewards == solution_rewards && residual < solution_residual)) {
               $.extend(true, solution_carts, carts);
           }           
       } else {
           var j;
           for (j = 0; j < carts.length; j++) {
               carts[j].push(prices[i]);
               _go(i + 1, target);
               carts[j].pop();
           }
           var newCart = [];
           newCart.push(prices[i]);
           carts.push(newCart);
           _go(i + 1, target);
           carts.pop();
       }
    }
    function _sum(a) {
        var i;
        var s = 0;
        for (i = 0; i < a.length; i++) {
            s += a[i];
        }
        return s;
    }
  </script>
</html>
